
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ python fastai_classification_crossVal.py
Loading data snopes...
(118, 5)
0    mixture
1     mfalse
2    mixture
3    mixture
4      mtrue
5     ffalse
6     mfalse
7      mtrue
8     ffalse
9     ffalse
Name: label, dtype: object
['mixture' 'mfalse' 'mtrue' 'ffalse' 'ftrue']
Data from Snopes looks like...
0     Massive Pedophile Ring With '70,000 Elite Mem...
1     NBC Bay Area's SkyRanger on Saturday captured...
2     Today is Flag Day, the anniversary of when 19...
3     HONOLULU Federal authorities on Friday added ...
4     Text smaller    Text bigger    We have all he...
5     A 79-year-old retired officer of the CIA, Bil...
6     Governor Jerry Brown is retiring but not befo...
7     Sneed: 108 could be the Cubs magic number thi...
8     Clint Eastwood, more famous for westerns than...
9     Delaware City Council passed a resolution thi...
Name: data, dtype: object
[5, 1, 5, 5, 0, 1, 1, 0, 1, 1]
0    48
1    44
5    26
dtype: int64
Loading data buzzfeedtop...
(33, 15)
                                               title                                                url        ...         publish_date_phase2      author_phase2
0  Babysitter transported to hospital after inser...  http://worldnewsdailyreport.com/babysitter-tra...        ...                  2017-05-03  Barbara Jennnings
1  FBI seizes over 3,000 penises during raid at m...  http://worldnewsdailyreport.com/fbi-seizes-ove...        ...                  2017-09-25  Barbara Jennnings
2  Charles Manson to be released on parole, to Jo...  http://www.breakingnews365.net/59690fb994b9c/c...        ...                         NaN                NaN

[3 rows x 15 columns]
Data from BuzzFeed looks like...
0    Cincinnati, Ohio | A 31-year old woman was adm...
1    FBI agents made an astonishing discovery this ...
2    Giant Squid Washes Ashore on Lake Michigan Mic...
3    Police have reportedly launched a murder inves...
4    Beaumont, Texas | An employee of the Jefferson...
5    WASHINGTON, DC (By J. McConkey)A group of lead...
6    WASHINGTON, D.C.  In another sweeping move aim...
7    Columbus, Ohio | An 83-year old woman was arre...
8    A couple was transported to the hospital in a ...
9    Darrel Whitaker from Glenwood Springs in Color...
Name: original_article_text_phase2, dtype: object
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
1    33
dtype: int64
Loading data perez...
(500, 3)
   Unnamed: 0                                               text  label
0           0  Jennifer Aniston dashes 'Friends' reunion hope...  legit
1           1  This Is What Brad Pitt Has Been Texting Jennif...  legit
2           2  Jennifer Aniston's spokesman denies reports th...  legit
Data from perez looks like...
0    Jennifer Aniston dashes 'Friends' reunion hope...
1    This Is What Brad Pitt Has Been Texting Jennif...
2    Jennifer Aniston's spokesman denies reports th...
3    Jennifer Aniston sparks adoption rumors\n\nBef...
4    Jennifer Aniston denies she had an affair with...
5    Jennifer Aniston: I'm Not a 'Sad, Childless Hu...
6    Jennifer Aniston Finally Pregnant At 48 Years ...
7    Brad Pitt is not reuniting with Jennifer Anist...
8    Miley And Liam Fighting? False Rumors Swirl Th...
9    Kristen Stewart not dropping another "Twilight...
Name: text, dtype: object
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
1    250
0    250
dtype: int64
Data loaded from disk!
(2600,) 866
Cross validation starts:
[ 434  435  436  437 ... 2596 2597 2598 2599] [   0    1    2    3 ... 1730 1731 1732 1733]
(1732,)
(868,)


 A sample of classifier training data:
   label                                               text
0      0  While Donald Trump Jr., Executive Vice Preside...
1      0  Anthony Weiner. | AP Photo/Richard Drew, File ...
2      0  Pence said the policy gives police authority t...
3      0  A shooter opened fire at the Cascade Mall on F...
4      0  VIDEO: Jimmy Fallon Sparks MOTHER LOAD Of ?Hur...
5      0  We are absolutely heartbroken to hear about th...
6      0   Looking for news you can trust?  Subscribe to...
7      0  Donald Trump took full advantage of the opport...
8      0   A school shooting at Marjory Stoneman Douglas...
9      0  Secretary of State John Kerry said at the Glob...
10     0  ?Charlotte should release police video of the ...
11     0   Were so close! Were just two weeks away from ...
12     0  "The West Wing" creator's storylines are provi...
13     0   Copyright by WFLA - All rights reserved  WKRG...
14     0  Story highlights Two police videos -- from a d...
15     0  Trump takes credit for 'bomb' call: 'I should ...
16     0  Former CIA chief: Obama's 'retrenchment' like ...
17     0  BOOM! Retired Marine Colonel Writes Scathing L...
18     0  ?Hedidn say the document was legitimate," Joe ...
19     0  Story highlights Hillary Clinton has a 6-point...
20     0  For the first time in PresidentObama tenure, t...
21     0  When word got out the Westboro Baptist Church ...
22     0   The brides parents Christopher and Denice, al...
23     0   This Thursday Ohio Republican Representative ...
24     0   Sen. Ted Cruzs comments came in response to a...
25     0  Under the Radar Blog Archives Select Date? Dec...
26     0  16505 SHARES SHARES FacebookTwitter GooglePint...
27     0  Clinton says doesn't bother her if Trump doesn...
28     0   Hillary Clinton and Donald Trump are still ho...
29     0  Story highlights "We have a much better unders...
..   ...                                                ...
70     0  Under the Radar Blog Archives Select Date? Dec...
71     0   This Friday, the Trump camp released a new li...
72     0  "I just wanted to get on with, I wanted to get...
73     0  Donald Trump on Tuesday morning floated the id...
74     0  The trust issue continues to be the major stum...
75     0   A photo of a man in Alberta mowing a lawn wit...
76     0  If Republicans and Donald Trump really care ab...
77     0  The epidemic of black men being killed at the ...
78     0  Story highlights "Transparent" creator Jill So...
79     0  Majority Leader Mitch McConnell announced the ...
80     0   Banks still doesn't know her reasoning for se...
81     0  On Saturday, September 17 at 8:30 pm EST, an e...
82     0  Were you worried that Donald Trump might fall ...
83     0   I didn't serve in the U.S. Military for 20+ y...
84     0  Story highlights The turn of events was somewh...
85     0  Obama weighs in on the debate President Barack...
86     0  The Third Circuit ruled on Monday that the tri...
87     0  2016 Clinton gets underTrump skin The Republic...
88     0  Mexico?s former President, Vicente Fox,isn shy...
89     0  Donald Trump has again made a huge mistake whi...
90     0   Apple will fight a federal magistrate's order...
91     0   Introduction to the ADA  The Americans with D...
92     0  Under the Radar Blog Archives Select Date? Dec...
93     0   US authorities will remove restrictions on im...
94     0   Hillary Clinton proposed on Thursday a new se...
95     0  A "journal" belonging to New York City bombing...
96     0  Several protesters and a dozen police officers...
97     0  Toby Keith has been forced to cancel his show ...
98     0  When Hillary Clinton resigned as U.S. secretar...
99     0  ?These wire transfers, Mr. President, seemingl...

[100 rows x 2 columns]
Language model loaded!
Building the text classifier...
epoch  train_loss  valid_loss  accuracy
1      0.557515    0.549768    0.701613
epoch  train_loss  valid_loss  accuracy
1      0.501141    0.424391    0.816820
saving the classifier...
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.6785, 0.3215]))
Results on training data:
              precision    recall  f1-score   support

           0       0.89      0.79      0.84       866
           1       0.81      0.90      0.85       866

   micro avg       0.85      0.85      0.85      1732
   macro avg       0.85      0.85      0.84      1732
weighted avg       0.85      0.85      0.84      1732

Results on validation data:
              precision    recall  f1-score   support

           0       0.86      0.77      0.82       434
           1       0.79      0.88      0.83       434

   micro avg       0.82      0.82      0.82       868
   macro avg       0.83      0.82      0.82       868
weighted avg       0.83      0.82      0.82       868

Test results on data sampled only from snopes (snopes312 dataset manually checked right items -- unseen claims):
[[ 0 48]
 [ 1 44]
 [ 5 26]]
Discarding items for label 5
Final size of dataset:
[[ 0 48]
 [ 1 44]]
Final size of remaining dataset:
[[ 5 26]]
              precision    recall  f1-score   support

           0       0.58      0.15      0.23        48
           1       0.49      0.89      0.63        44

   micro avg       0.50      0.50      0.50        92
   macro avg       0.54      0.52      0.43        92
weighted avg       0.54      0.50      0.42        92

Test results on data sampled only from buzzfeedTop (mixed claims):
[[ 1 33]]
Final size of dataset:
[[ 1 33]]
Final size of remaining dataset:
[]
Traceback (most recent call last):
  File "fastai_classification_crossVal.py", line 425, in <module>
    print(classification_report(labels_test, y))
  File "/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/metrics/classification.py", line 1528, in classification_report
    labels = unique_labels(y_true, y_pred)
  File "/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/utils/multiclass.py", line 102, in unique_labels
    raise ValueError("Mix of label input types (string and number)")
ValueError: Mix of label input types (string and number)
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ nano fastai_classification_crossVal.py
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ nano fastai_classification_crossVal.py
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ nano fastai_classification_crossVal.py
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ python fastai_classification_crossVal.py
Loading data snopes...
(118, 5)
0    mixture
1     mfalse
2    mixture
3    mixture
4      mtrue
5     ffalse
6     mfalse
7      mtrue
8     ffalse
9     ffalse
Name: label, dtype: object
['mixture' 'mfalse' 'mtrue' 'ffalse' 'ftrue']
Data from Snopes looks like...
0     Massive Pedophile Ring With '70,000 Elite Mem...
1     NBC Bay Area's SkyRanger on Saturday captured...
2     Today is Flag Day, the anniversary of when 19...
3     HONOLULU Federal authorities on Friday added ...
4     Text smaller    Text bigger    We have all he...
5     A 79-year-old retired officer of the CIA, Bil...
6     Governor Jerry Brown is retiring but not befo...
7     Sneed: 108 could be the Cubs magic number thi...
8     Clint Eastwood, more famous for westerns than...
9     Delaware City Council passed a resolution thi...
Name: data, dtype: object
[5, 1, 5, 5, 0, 1, 1, 0, 1, 1]
0    48
1    44
5    26
dtype: int64
Loading data buzzfeedtop...
(33, 15)
                                               title                                                url        ...         publish_date_phase2      author_phase2
0  Babysitter transported to hospital after inser...  http://worldnewsdailyreport.com/babysitter-tra...        ...                  2017-05-03  Barbara Jennnings
1  FBI seizes over 3,000 penises during raid at m...  http://worldnewsdailyreport.com/fbi-seizes-ove...        ...                  2017-09-25  Barbara Jennnings
2  Charles Manson to be released on parole, to Jo...  http://www.breakingnews365.net/59690fb994b9c/c...        ...                         NaN                NaN

[3 rows x 15 columns]
Data from BuzzFeed looks like...
0    Cincinnati, Ohio | A 31-year old woman was adm...
1    FBI agents made an astonishing discovery this ...
2    Giant Squid Washes Ashore on Lake Michigan Mic...
3    Police have reportedly launched a murder inves...
4    Beaumont, Texas | An employee of the Jefferson...
5    WASHINGTON, DC (By J. McConkey)A group of lead...
6    WASHINGTON, D.C.  In another sweeping move aim...
7    Columbus, Ohio | An 83-year old woman was arre...
8    A couple was transported to the hospital in a ...
9    Darrel Whitaker from Glenwood Springs in Color...
Name: original_article_text_phase2, dtype: object
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
1    33
dtype: int64
Loading data perez...
(500, 3)
   Unnamed: 0                                               text  label
0           0  Jennifer Aniston dashes 'Friends' reunion hope...  legit
1           1  This Is What Brad Pitt Has Been Texting Jennif...  legit
2           2  Jennifer Aniston's spokesman denies reports th...  legit
Data from perez looks like...
0    Jennifer Aniston dashes 'Friends' reunion hope...
1    This Is What Brad Pitt Has Been Texting Jennif...
2    Jennifer Aniston's spokesman denies reports th...
3    Jennifer Aniston sparks adoption rumors\n\nBef...
4    Jennifer Aniston denies she had an affair with...
5    Jennifer Aniston: I'm Not a 'Sad, Childless Hu...
6    Jennifer Aniston Finally Pregnant At 48 Years ...
7    Brad Pitt is not reuniting with Jennifer Anist...
8    Miley And Liam Fighting? False Rumors Swirl Th...
9    Kristen Stewart not dropping another "Twilight...
Name: text, dtype: object
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
1    250
0    250
dtype: int64
Data loaded from disk!
(2600,) 866
Cross validation starts:
[ 434  435  436  437 ... 2596 2597 2598 2599] [   0    1    2    3 ... 1730 1731 1732 1733]
(1732,)
(868,)


 A sample of classifier training data:
   label                                               text
0      0  While Donald Trump Jr., Executive Vice Preside...
1      0  Anthony Weiner. | AP Photo/Richard Drew, File ...
2      0  Pence said the policy gives police authority t...
3      0  A shooter opened fire at the Cascade Mall on F...
4      0  VIDEO: Jimmy Fallon Sparks MOTHER LOAD Of ?Hur...
5      0  We are absolutely heartbroken to hear about th...
6      0   Looking for news you can trust?  Subscribe to...
7      0  Donald Trump took full advantage of the opport...
8      0   A school shooting at Marjory Stoneman Douglas...
9      0  Secretary of State John Kerry said at the Glob...
10     0  ?Charlotte should release police video of the ...
11     0   Were so close! Were just two weeks away from ...
12     0  "The West Wing" creator's storylines are provi...
13     0   Copyright by WFLA - All rights reserved  WKRG...
14     0  Story highlights Two police videos -- from a d...
15     0  Trump takes credit for 'bomb' call: 'I should ...
16     0  Former CIA chief: Obama's 'retrenchment' like ...
17     0  BOOM! Retired Marine Colonel Writes Scathing L...
18     0  ?Hedidn say the document was legitimate," Joe ...
19     0  Story highlights Hillary Clinton has a 6-point...
20     0  For the first time in PresidentObama tenure, t...
21     0  When word got out the Westboro Baptist Church ...
22     0   The brides parents Christopher and Denice, al...
23     0   This Thursday Ohio Republican Representative ...
24     0   Sen. Ted Cruzs comments came in response to a...
25     0  Under the Radar Blog Archives Select Date? Dec...
26     0  16505 SHARES SHARES FacebookTwitter GooglePint...
27     0  Clinton says doesn't bother her if Trump doesn...
28     0   Hillary Clinton and Donald Trump are still ho...
29     0  Story highlights "We have a much better unders...
..   ...                                                ...
70     0  Under the Radar Blog Archives Select Date? Dec...
71     0   This Friday, the Trump camp released a new li...
72     0  "I just wanted to get on with, I wanted to get...
73     0  Donald Trump on Tuesday morning floated the id...
74     0  The trust issue continues to be the major stum...
75     0   A photo of a man in Alberta mowing a lawn wit...
76     0  If Republicans and Donald Trump really care ab...
77     0  The epidemic of black men being killed at the ...
78     0  Story highlights "Transparent" creator Jill So...
79     0  Majority Leader Mitch McConnell announced the ...
80     0   Banks still doesn't know her reasoning for se...
81     0  On Saturday, September 17 at 8:30 pm EST, an e...
82     0  Were you worried that Donald Trump might fall ...
83     0   I didn't serve in the U.S. Military for 20+ y...
84     0  Story highlights The turn of events was somewh...
85     0  Obama weighs in on the debate President Barack...
86     0  The Third Circuit ruled on Monday that the tri...
87     0  2016 Clinton gets underTrump skin The Republic...
88     0  Mexico?s former President, Vicente Fox,isn shy...
89     0  Donald Trump has again made a huge mistake whi...
90     0   Apple will fight a federal magistrate's order...
91     0   Introduction to the ADA  The Americans with D...
92     0  Under the Radar Blog Archives Select Date? Dec...
93     0   US authorities will remove restrictions on im...
94     0   Hillary Clinton proposed on Thursday a new se...
95     0  A "journal" belonging to New York City bombing...
96     0  Several protesters and a dozen police officers...
97     0  Toby Keith has been forced to cancel his show ...
98     0  When Hillary Clinton resigned as U.S. secretar...
99     0  ?These wire transfers, Mr. President, seemingl...

[100 rows x 2 columns]
Language model loaded!
Building the text classifier...
epoch  train_loss  valid_loss  accuracy
1      0.557515    0.549768    0.701613
epoch  train_loss  valid_loss  accuracy
1      0.501141    0.424391    0.816820
saving the classifier...
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.6785, 0.3215]))
Results on training data:
              precision    recall  f1-score   support

           0       0.89      0.79      0.84       866
           1       0.81      0.90      0.85       866

   micro avg       0.85      0.85      0.85      1732
   macro avg       0.85      0.85      0.84      1732
weighted avg       0.85      0.85      0.84      1732

Results on validation data:
              precision    recall  f1-score   support

           0       0.86      0.77      0.82       434
           1       0.79      0.88      0.83       434

   micro avg       0.82      0.82      0.82       868
   macro avg       0.83      0.82      0.82       868
weighted avg       0.83      0.82      0.82       868

Test results on data sampled only from snopes (snopes312 dataset manually checked right items -- unseen claims):
[[ 0 48]
 [ 1 44]
 [ 5 26]]
Discarding items for label 5
Final size of dataset:
[[ 0 48]
 [ 1 44]]
Final size of remaining dataset:
[[ 5 26]]
              precision    recall  f1-score   support

           0       0.58      0.15      0.23        48
           1       0.49      0.89      0.63        44

   micro avg       0.50      0.50      0.50        92
   macro avg       0.54      0.52      0.43        92
weighted avg       0.54      0.50      0.42        92

Test results on data sampled only from buzzfeedTop (mixed claims):
[[ 1 33]]
Final size of dataset:
[[ 1 33]]
Final size of remaining dataset:
[]
<class 'numpy.ndarray'> <class 'list'>
1 1
Traceback (most recent call last):
  File "fastai_classification_crossVal.py", line 427, in <module>
    print(labels_test.shape, y.shape)
AttributeError: 'list' object has no attribute 'shape'
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ nano fastai_classification_crossVal.py
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ python fastai_classification_crossVal.py
Loading data snopes...
(118, 5)
0    mixture
1     mfalse
2    mixture
3    mixture
4      mtrue
5     ffalse
6     mfalse
7      mtrue
8     ffalse
9     ffalse
Name: label, dtype: object
['mixture' 'mfalse' 'mtrue' 'ffalse' 'ftrue']
Data from Snopes looks like...
0     Massive Pedophile Ring With '70,000 Elite Mem...
1     NBC Bay Area's SkyRanger on Saturday captured...
2     Today is Flag Day, the anniversary of when 19...
3     HONOLULU Federal authorities on Friday added ...
4     Text smaller    Text bigger    We have all he...
5     A 79-year-old retired officer of the CIA, Bil...
6     Governor Jerry Brown is retiring but not befo...
7     Sneed: 108 could be the Cubs magic number thi...
8     Clint Eastwood, more famous for westerns than...
9     Delaware City Council passed a resolution thi...
Name: data, dtype: object
[5, 1, 5, 5, 0, 1, 1, 0, 1, 1]
0    48
1    44
5    26
dtype: int64
Loading data buzzfeedtop...
(33, 15)
                                               title        ...              author_phase2
0  Babysitter transported to hospital after inser...        ...          Barbara Jennnings
1  FBI seizes over 3,000 penises during raid at m...        ...          Barbara Jennnings
2  Charles Manson to be released on parole, to Jo...        ...                        NaN

[3 rows x 15 columns]
Data from BuzzFeed looks like...
0    Cincinnati, Ohio | A 31-year old woman was adm...
1    FBI agents made an astonishing discovery this ...
2    Giant Squid Washes Ashore on Lake Michigan Mic...
3    Police have reportedly launched a murder inves...
4    Beaumont, Texas | An employee of the Jefferson...
5    WASHINGTON, DC (By J. McConkey)A group of lead...
6    WASHINGTON, D.C.  In another sweeping move aim...
7    Columbus, Ohio | An 83-year old woman was arre...
8    A couple was transported to the hospital in a ...
9    Darrel Whitaker from Glenwood Springs in Color...
Name: original_article_text_phase2, dtype: object
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
1    33
dtype: int64
Loading data perez...
(500, 3)
   Unnamed: 0                                               text  label
0           0  Jennifer Aniston dashes 'Friends' reunion hope...  legit
1           1  This Is What Brad Pitt Has Been Texting Jennif...  legit
2           2  Jennifer Aniston's spokesman denies reports th...  legit
Data from perez looks like...
0    Jennifer Aniston dashes 'Friends' reunion hope...
1    This Is What Brad Pitt Has Been Texting Jennif...
2    Jennifer Aniston's spokesman denies reports th...
3    Jennifer Aniston sparks adoption rumors\n\nBef...
4    Jennifer Aniston denies she had an affair with...
5    Jennifer Aniston: I'm Not a 'Sad, Childless Hu...
6    Jennifer Aniston Finally Pregnant At 48 Years ...
7    Brad Pitt is not reuniting with Jennifer Anist...
8    Miley And Liam Fighting? False Rumors Swirl Th...
9    Kristen Stewart not dropping another "Twilight...
Name: text, dtype: object
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
1    250
0    250
dtype: int64
Data loaded from disk!
(2600,) 866
Cross validation starts:
[ 434  435  436  437 ... 2596 2597 2598 2599] [   0    1    2    3 ... 1730 1731 1732 1733]
(1732,)
(868,)


 A sample of classifier training data:
   label                                               text
0      0  While Donald Trump Jr., Executive Vice Preside...
1      0  Anthony Weiner. | AP Photo/Richard Drew, File ...
2      0  Pence said the policy gives police authority t...
3      0  A shooter opened fire at the Cascade Mall on F...
4      0  VIDEO: Jimmy Fallon Sparks MOTHER LOAD Of ?Hur...
5      0  We are absolutely heartbroken to hear about th...
6      0   Looking for news you can trust?  Subscribe to...
7      0  Donald Trump took full advantage of the opport...
8      0   A school shooting at Marjory Stoneman Douglas...
9      0  Secretary of State John Kerry said at the Glob...
10     0  ?Charlotte should release police video of the ...
11     0   Were so close! Were just two weeks away from ...
12     0  "The West Wing" creator's storylines are provi...
13     0   Copyright by WFLA - All rights reserved  WKRG...
14     0  Story highlights Two police videos -- from a d...
15     0  Trump takes credit for 'bomb' call: 'I should ...
16     0  Former CIA chief: Obama's 'retrenchment' like ...
17     0  BOOM! Retired Marine Colonel Writes Scathing L...
18     0  ?Hedidn say the document was legitimate," Joe ...
19     0  Story highlights Hillary Clinton has a 6-point...
20     0  For the first time in PresidentObama tenure, t...
21     0  When word got out the Westboro Baptist Church ...
22     0   The brides parents Christopher and Denice, al...
23     0   This Thursday Ohio Republican Representative ...
24     0   Sen. Ted Cruzs comments came in response to a...
25     0  Under the Radar Blog Archives Select Date? Dec...
26     0  16505 SHARES SHARES FacebookTwitter GooglePint...
27     0  Clinton says doesn't bother her if Trump doesn...
28     0   Hillary Clinton and Donald Trump are still ho...
29     0  Story highlights "We have a much better unders...
..   ...                                                ...
70     0  Under the Radar Blog Archives Select Date? Dec...
71     0   This Friday, the Trump camp released a new li...
72     0  "I just wanted to get on with, I wanted to get...
73     0  Donald Trump on Tuesday morning floated the id...
74     0  The trust issue continues to be the major stum...
75     0   A photo of a man in Alberta mowing a lawn wit...
76     0  If Republicans and Donald Trump really care ab...
77     0  The epidemic of black men being killed at the ...
78     0  Story highlights "Transparent" creator Jill So...
79     0  Majority Leader Mitch McConnell announced the ...
80     0   Banks still doesn't know her reasoning for se...
81     0  On Saturday, September 17 at 8:30 pm EST, an e...
82     0  Were you worried that Donald Trump might fall ...
83     0   I didn't serve in the U.S. Military for 20+ y...
84     0  Story highlights The turn of events was somewh...
85     0  Obama weighs in on the debate President Barack...
86     0  The Third Circuit ruled on Monday that the tri...
87     0  2016 Clinton gets underTrump skin The Republic...
88     0  Mexico?s former President, Vicente Fox,isn shy...
89     0  Donald Trump has again made a huge mistake whi...
90     0   Apple will fight a federal magistrate's order...
91     0   Introduction to the ADA  The Americans with D...
92     0  Under the Radar Blog Archives Select Date? Dec...
93     0   US authorities will remove restrictions on im...
94     0   Hillary Clinton proposed on Thursday a new se...
95     0  A "journal" belonging to New York City bombing...
96     0  Several protesters and a dozen police officers...
97     0  Toby Keith has been forced to cancel his show ...
98     0  When Hillary Clinton resigned as U.S. secretar...
99     0  ?These wire transfers, Mr. President, seemingl...

[100 rows x 2 columns]
Language model loaded!
Building the text classifier...
epoch  train_loss  valid_loss  accuracy
1      0.557515    0.549768    0.701613
epoch  train_loss  valid_loss  accuracy
1      0.501141    0.424391    0.816820
saving the classifier...
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.6785, 0.3215]))
Results on training data:
              precision    recall  f1-score   support

           0       0.89      0.79      0.84       866
           1       0.81      0.90      0.85       866

   micro avg       0.85      0.85      0.85      1732
   macro avg       0.85      0.85      0.84      1732
weighted avg       0.85      0.85      0.84      1732

Results on validation data:
              precision    recall  f1-score   support

           0       0.86      0.77      0.82       434
           1       0.79      0.88      0.83       434

   micro avg       0.82      0.82      0.82       868
   macro avg       0.83      0.82      0.82       868
weighted avg       0.83      0.82      0.82       868

Test results on data sampled only from snopes (snopes312 dataset manually checked right items -- unseen claims):
[[ 0 48]
 [ 1 44]
 [ 5 26]]
Discarding items for label 5
Final size of dataset:
[[ 0 48]
 [ 1 44]]
Final size of remaining dataset:
[[ 5 26]]
              precision    recall  f1-score   support

           0       0.58      0.15      0.23        48
           1       0.49      0.89      0.63        44

   micro avg       0.50      0.50      0.50        92
   macro avg       0.54      0.52      0.43        92
weighted avg       0.54      0.50      0.42        92

Test results on data sampled only from buzzfeedTop (mixed claims):
[[ 1 33]]
Final size of dataset:
[[ 1 33]]
Final size of remaining dataset:
[]
<class 'numpy.ndarray'> <class 'list'>
1 1
(33,) 33
Traceback (most recent call last):
  File "fastai_classification_crossVal.py", line 428, in <module>
    print(classification_report(labels_test, np.ndarray(y)))
ValueError: sequence too large; cannot be greater than 32
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ nano fastai_classification_crossVal.py
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ nano fastai_classification_crossVal.py
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ python fastai_classification_crossVal.py
Loading data snopes...
(118, 5)
0    mixture
1     mfalse
2    mixture
3    mixture
4      mtrue
5     ffalse
6     mfalse
7      mtrue
8     ffalse
9     ffalse
Name: label, dtype: object
['mixture' 'mfalse' 'mtrue' 'ffalse' 'ftrue']
Data from Snopes looks like...
0     Massive Pedophile Ring With '70,000 Elite Mem...
1     NBC Bay Area's SkyRanger on Saturday captured...
2     Today is Flag Day, the anniversary of when 19...
3     HONOLULU Federal authorities on Friday added ...
4     Text smaller    Text bigger    We have all he...
5     A 79-year-old retired officer of the CIA, Bil...
6     Governor Jerry Brown is retiring but not befo...
7     Sneed: 108 could be the Cubs magic number thi...
8     Clint Eastwood, more famous for westerns than...
9     Delaware City Council passed a resolution thi...
Name: data, dtype: object
[5, 1, 5, 5, 0, 1, 1, 0, 1, 1]
0    48
1    44
5    26
dtype: int64
Loading data buzzfeedtop...
(33, 15)
                                               title        ...              author_phase2
0  Babysitter transported to hospital after inser...        ...          Barbara Jennnings
1  FBI seizes over 3,000 penises during raid at m...        ...          Barbara Jennnings
2  Charles Manson to be released on parole, to Jo...        ...                        NaN

[3 rows x 15 columns]
Data from BuzzFeed looks like...
0    Cincinnati, Ohio | A 31-year old woman was adm...
1    FBI agents made an astonishing discovery this ...
2    Giant Squid Washes Ashore on Lake Michigan Mic...
3    Police have reportedly launched a murder inves...
4    Beaumont, Texas | An employee of the Jefferson...
5    WASHINGTON, DC (By J. McConkey)A group of lead...
6    WASHINGTON, D.C.  In another sweeping move aim...
7    Columbus, Ohio | An 83-year old woman was arre...
8    A couple was transported to the hospital in a ...
9    Darrel Whitaker from Glenwood Springs in Color...
Name: original_article_text_phase2, dtype: object
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
1    33
dtype: int64
Loading data perez...
(500, 3)
   Unnamed: 0                                               text  label
0           0  Jennifer Aniston dashes 'Friends' reunion hope...  legit
1           1  This Is What Brad Pitt Has Been Texting Jennif...  legit
2           2  Jennifer Aniston's spokesman denies reports th...  legit
Data from perez looks like...
0    Jennifer Aniston dashes 'Friends' reunion hope...
1    This Is What Brad Pitt Has Been Texting Jennif...
2    Jennifer Aniston's spokesman denies reports th...
3    Jennifer Aniston sparks adoption rumors\n\nBef...
4    Jennifer Aniston denies she had an affair with...
5    Jennifer Aniston: I'm Not a 'Sad, Childless Hu...
6    Jennifer Aniston Finally Pregnant At 48 Years ...
7    Brad Pitt is not reuniting with Jennifer Anist...
8    Miley And Liam Fighting? False Rumors Swirl Th...
9    Kristen Stewart not dropping another "Twilight...
Name: text, dtype: object
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
1    250
0    250
dtype: int64
Data loaded from disk!
(2600,) 866
Cross validation starts:
[ 434  435  436  437 ... 2596 2597 2598 2599] [   0    1    2    3 ... 1730 1731 1732 1733]
(1732,)
(868,)


 A sample of classifier training data:
   label                                               text
0      0  While Donald Trump Jr., Executive Vice Preside...
1      0  Anthony Weiner. | AP Photo/Richard Drew, File ...
2      0  Pence said the policy gives police authority t...
3      0  A shooter opened fire at the Cascade Mall on F...
4      0  VIDEO: Jimmy Fallon Sparks MOTHER LOAD Of ?Hur...
5      0  We are absolutely heartbroken to hear about th...
6      0   Looking for news you can trust?  Subscribe to...
7      0  Donald Trump took full advantage of the opport...
8      0   A school shooting at Marjory Stoneman Douglas...
9      0  Secretary of State John Kerry said at the Glob...
10     0  ?Charlotte should release police video of the ...
11     0   Were so close! Were just two weeks away from ...
12     0  "The West Wing" creator's storylines are provi...
13     0   Copyright by WFLA - All rights reserved  WKRG...
14     0  Story highlights Two police videos -- from a d...
15     0  Trump takes credit for 'bomb' call: 'I should ...
16     0  Former CIA chief: Obama's 'retrenchment' like ...
17     0  BOOM! Retired Marine Colonel Writes Scathing L...
18     0  ?Hedidn say the document was legitimate," Joe ...
19     0  Story highlights Hillary Clinton has a 6-point...
20     0  For the first time in PresidentObama tenure, t...
21     0  When word got out the Westboro Baptist Church ...
22     0   The brides parents Christopher and Denice, al...
23     0   This Thursday Ohio Republican Representative ...
24     0   Sen. Ted Cruzs comments came in response to a...
25     0  Under the Radar Blog Archives Select Date? Dec...
26     0  16505 SHARES SHARES FacebookTwitter GooglePint...
27     0  Clinton says doesn't bother her if Trump doesn...
28     0   Hillary Clinton and Donald Trump are still ho...
29     0  Story highlights "We have a much better unders...
..   ...                                                ...
70     0  Under the Radar Blog Archives Select Date? Dec...
71     0   This Friday, the Trump camp released a new li...
72     0  "I just wanted to get on with, I wanted to get...
73     0  Donald Trump on Tuesday morning floated the id...
74     0  The trust issue continues to be the major stum...
75     0   A photo of a man in Alberta mowing a lawn wit...
76     0  If Republicans and Donald Trump really care ab...
77     0  The epidemic of black men being killed at the ...
78     0  Story highlights "Transparent" creator Jill So...
79     0  Majority Leader Mitch McConnell announced the ...
80     0   Banks still doesn't know her reasoning for se...
81     0  On Saturday, September 17 at 8:30 pm EST, an e...
82     0  Were you worried that Donald Trump might fall ...
83     0   I didn't serve in the U.S. Military for 20+ y...
84     0  Story highlights The turn of events was somewh...
85     0  Obama weighs in on the debate President Barack...
86     0  The Third Circuit ruled on Monday that the tri...
87     0  2016 Clinton gets underTrump skin The Republic...
88     0  Mexico?s former President, Vicente Fox,isn shy...
89     0  Donald Trump has again made a huge mistake whi...
90     0   Apple will fight a federal magistrate's order...
91     0   Introduction to the ADA  The Americans with D...
92     0  Under the Radar Blog Archives Select Date? Dec...
93     0   US authorities will remove restrictions on im...
94     0   Hillary Clinton proposed on Thursday a new se...
95     0  A "journal" belonging to New York City bombing...
96     0  Several protesters and a dozen police officers...
97     0  Toby Keith has been forced to cancel his show ...
98     0  When Hillary Clinton resigned as U.S. secretar...
99     0  ?These wire transfers, Mr. President, seemingl...

[100 rows x 2 columns]
Language model loaded!
Building the text classifier...
epoch  train_loss  valid_loss  accuracy
1      0.557515    0.549768    0.701613
epoch  train_loss  valid_loss  accuracy
1      0.501141    0.424391    0.816820
saving the classifier...
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.6785, 0.3215]))
Results on training data:
              precision    recall  f1-score   support

           0       0.89      0.79      0.84       866
           1       0.81      0.90      0.85       866

   micro avg       0.85      0.85      0.85      1732
   macro avg       0.85      0.85      0.84      1732
weighted avg       0.85      0.85      0.84      1732

Results on validation data:
              precision    recall  f1-score   support

           0       0.86      0.77      0.82       434
           1       0.79      0.88      0.83       434

   micro avg       0.82      0.82      0.82       868
   macro avg       0.83      0.82      0.82       868
weighted avg       0.83      0.82      0.82       868

Test results on data sampled only from snopes (snopes312 dataset manually checked right items -- unseen claims):
[[ 0 48]
 [ 1 44]
 [ 5 26]]
Discarding items for label 5
Final size of dataset:
[[ 0 48]
 [ 1 44]]
Final size of remaining dataset:
[[ 5 26]]
              precision    recall  f1-score   support

           0       0.58      0.15      0.23        48
           1       0.49      0.89      0.63        44

   micro avg       0.50      0.50      0.50        92
   macro avg       0.54      0.52      0.43        92
weighted avg       0.54      0.50      0.42        92

Test results on data sampled only from buzzfeedTop (mixed claims):
[[ 1 33]]
Final size of dataset:
[[ 1 33]]
Final size of remaining dataset:
[]
<class 'numpy.ndarray'> <class 'list'>
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1] ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '0', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1']
(33,) 33
Traceback (most recent call last):
  File "fastai_classification_crossVal.py", line 428, in <module>
    print(classification_report(labels_test, np.asarray(y)))
  File "/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/metrics/classification.py", line 1528, in classification_report
    labels = unique_labels(y_true, y_pred)
  File "/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/utils/multiclass.py", line 102, in unique_labels
    raise ValueError("Mix of label input types (string and number)")
ValueError: Mix of label input types (string and number)
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ nano fastai_classification_crossVal.py
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ python fastai_classification_crossVal.py
Loading data snopes...
(118, 5)
0    mixture
1     mfalse
2    mixture
3    mixture
4      mtrue
5     ffalse
6     mfalse
7      mtrue
8     ffalse
9     ffalse
Name: label, dtype: object
['mixture' 'mfalse' 'mtrue' 'ffalse' 'ftrue']
Data from Snopes looks like...
0     Massive Pedophile Ring With '70,000 Elite Mem...
1     NBC Bay Area's SkyRanger on Saturday captured...
2     Today is Flag Day, the anniversary of when 19...
3     HONOLULU Federal authorities on Friday added ...
4     Text smaller    Text bigger    We have all he...
5     A 79-year-old retired officer of the CIA, Bil...
6     Governor Jerry Brown is retiring but not befo...
7     Sneed: 108 could be the Cubs magic number thi...
8     Clint Eastwood, more famous for westerns than...
9     Delaware City Council passed a resolution thi...
Name: data, dtype: object
[5, 1, 5, 5, 0, 1, 1, 0, 1, 1]
0    48
1    44
5    26
dtype: int64
Loading data buzzfeedtop...
(33, 15)
                                               title        ...              author_phase2
0  Babysitter transported to hospital after inser...        ...          Barbara Jennnings
1  FBI seizes over 3,000 penises during raid at m...        ...          Barbara Jennnings
2  Charles Manson to be released on parole, to Jo...        ...                        NaN

[3 rows x 15 columns]
Data from BuzzFeed looks like...
0    Cincinnati, Ohio | A 31-year old woman was adm...
1    FBI agents made an astonishing discovery this ...
2    Giant Squid Washes Ashore on Lake Michigan Mic...
3    Police have reportedly launched a murder inves...
4    Beaumont, Texas | An employee of the Jefferson...
5    WASHINGTON, DC (By J. McConkey)A group of lead...
6    WASHINGTON, D.C.  In another sweeping move aim...
7    Columbus, Ohio | An 83-year old woman was arre...
8    A couple was transported to the hospital in a ...
9    Darrel Whitaker from Glenwood Springs in Color...
Name: original_article_text_phase2, dtype: object
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
1    33
dtype: int64
Loading data perez...
(500, 3)
   Unnamed: 0                                               text  label
0           0  Jennifer Aniston dashes 'Friends' reunion hope...  legit
1           1  This Is What Brad Pitt Has Been Texting Jennif...  legit
2           2  Jennifer Aniston's spokesman denies reports th...  legit
Data from perez looks like...
0    Jennifer Aniston dashes 'Friends' reunion hope...
1    This Is What Brad Pitt Has Been Texting Jennif...
2    Jennifer Aniston's spokesman denies reports th...
3    Jennifer Aniston sparks adoption rumors\n\nBef...
4    Jennifer Aniston denies she had an affair with...
5    Jennifer Aniston: I'm Not a 'Sad, Childless Hu...
6    Jennifer Aniston Finally Pregnant At 48 Years ...
7    Brad Pitt is not reuniting with Jennifer Anist...
8    Miley And Liam Fighting? False Rumors Swirl Th...
9    Kristen Stewart not dropping another "Twilight...
Name: text, dtype: object
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
1    250
0    250
dtype: int64
Data loaded from disk!
(2600,) 866
Cross validation starts:
[ 434  435  436  437 ... 2596 2597 2598 2599] [   0    1    2    3 ... 1730 1731 1732 1733]
(1732,)
(868,)


 A sample of classifier training data:
   label                                               text
0      0  While Donald Trump Jr., Executive Vice Preside...
1      0  Anthony Weiner. | AP Photo/Richard Drew, File ...
2      0  Pence said the policy gives police authority t...
3      0  A shooter opened fire at the Cascade Mall on F...
4      0  VIDEO: Jimmy Fallon Sparks MOTHER LOAD Of ?Hur...
5      0  We are absolutely heartbroken to hear about th...
6      0   Looking for news you can trust?  Subscribe to...
7      0  Donald Trump took full advantage of the opport...
8      0   A school shooting at Marjory Stoneman Douglas...
9      0  Secretary of State John Kerry said at the Glob...
10     0  ?Charlotte should release police video of the ...
11     0   Were so close! Were just two weeks away from ...
12     0  "The West Wing" creator's storylines are provi...
13     0   Copyright by WFLA - All rights reserved  WKRG...
14     0  Story highlights Two police videos -- from a d...
15     0  Trump takes credit for 'bomb' call: 'I should ...
16     0  Former CIA chief: Obama's 'retrenchment' like ...
17     0  BOOM! Retired Marine Colonel Writes Scathing L...
18     0  ?Hedidn say the document was legitimate," Joe ...
19     0  Story highlights Hillary Clinton has a 6-point...
20     0  For the first time in PresidentObama tenure, t...
21     0  When word got out the Westboro Baptist Church ...
22     0   The brides parents Christopher and Denice, al...
23     0   This Thursday Ohio Republican Representative ...
24     0   Sen. Ted Cruzs comments came in response to a...
25     0  Under the Radar Blog Archives Select Date? Dec...
26     0  16505 SHARES SHARES FacebookTwitter GooglePint...
27     0  Clinton says doesn't bother her if Trump doesn...
28     0   Hillary Clinton and Donald Trump are still ho...
29     0  Story highlights "We have a much better unders...
..   ...                                                ...
70     0  Under the Radar Blog Archives Select Date? Dec...
71     0   This Friday, the Trump camp released a new li...
72     0  "I just wanted to get on with, I wanted to get...
73     0  Donald Trump on Tuesday morning floated the id...
74     0  The trust issue continues to be the major stum...
75     0   A photo of a man in Alberta mowing a lawn wit...
76     0  If Republicans and Donald Trump really care ab...
77     0  The epidemic of black men being killed at the ...
78     0  Story highlights "Transparent" creator Jill So...
79     0  Majority Leader Mitch McConnell announced the ...
80     0   Banks still doesn't know her reasoning for se...
81     0  On Saturday, September 17 at 8:30 pm EST, an e...
82     0  Were you worried that Donald Trump might fall ...
83     0   I didn't serve in the U.S. Military for 20+ y...
84     0  Story highlights The turn of events was somewh...
85     0  Obama weighs in on the debate President Barack...
86     0  The Third Circuit ruled on Monday that the tri...
87     0  2016 Clinton gets underTrump skin The Republic...
88     0  Mexico?s former President, Vicente Fox,isn shy...
89     0  Donald Trump has again made a huge mistake whi...
90     0   Apple will fight a federal magistrate's order...
91     0   Introduction to the ADA  The Americans with D...
92     0  Under the Radar Blog Archives Select Date? Dec...
93     0   US authorities will remove restrictions on im...
94     0   Hillary Clinton proposed on Thursday a new se...
95     0  A "journal" belonging to New York City bombing...
96     0  Several protesters and a dozen police officers...
97     0  Toby Keith has been forced to cancel his show ...
98     0  When Hillary Clinton resigned as U.S. secretar...
99     0  ?These wire transfers, Mr. President, seemingl...

[100 rows x 2 columns]
Language model loaded!
Building the text classifier...
epoch  train_loss  valid_loss  accuracy
1      0.557515    0.549768    0.701613
epoch  train_loss  valid_loss  accuracy
1      0.501141    0.424391    0.816820
saving the classifier...
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.6785, 0.3215]))
Results on training data:
              precision    recall  f1-score   support

           0       0.89      0.79      0.84       866
           1       0.81      0.90      0.85       866

   micro avg       0.85      0.85      0.85      1732
   macro avg       0.85      0.85      0.84      1732
weighted avg       0.85      0.85      0.84      1732

Results on validation data:
              precision    recall  f1-score   support

           0       0.86      0.77      0.82       434
           1       0.79      0.88      0.83       434

   micro avg       0.82      0.82      0.82       868
   macro avg       0.83      0.82      0.82       868
weighted avg       0.83      0.82      0.82       868

Test results on data sampled only from snopes (snopes312 dataset manually checked right items -- unseen claims):
[[ 0 48]
 [ 1 44]
 [ 5 26]]
Discarding items for label 5
Final size of dataset:
[[ 0 48]
 [ 1 44]]
Final size of remaining dataset:
[[ 5 26]]
              precision    recall  f1-score   support

           0       0.58      0.15      0.23        48
           1       0.49      0.89      0.63        44

   micro avg       0.50      0.50      0.50        92
   macro avg       0.54      0.52      0.43        92
weighted avg       0.54      0.50      0.42        92

Test results on data sampled only from buzzfeedTop (mixed claims):
[[ 1 33]]
Final size of dataset:
[[ 1 33]]
Final size of remaining dataset:
[]
<class 'numpy.ndarray'> <class 'list'>
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1] ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '0', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1']
(33,) 33
/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/metrics/classification.py:1145: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples.
  'recall', 'true', average, warn_for)
              precision    recall  f1-score   support

           0       0.00      0.00      0.00         0
           1       1.00      0.97      0.98        33

   micro avg       0.97      0.97      0.97        33
   macro avg       0.50      0.48      0.49        33
weighted avg       1.00      0.97      0.98        33

Test results on data sampled only from perez (celebrity stories):
[[  0 250]
 [  1 250]]
Final size of dataset:
[[  0 250]
 [  1 250]]
Final size of remaining dataset:
[]
Traceback (most recent call last):
  File "fastai_classification_crossVal.py", line 434, in <module>
    print(classification_report(labels_test, y))
  File "/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/metrics/classification.py", line 1528, in classification_report
    labels = unique_labels(y_true, y_pred)
  File "/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/utils/multiclass.py", line 102, in unique_labels
    raise ValueError("Mix of label input types (string and number)")
ValueError: Mix of label input types (string and number)
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ nano fastai_classification_crossVal.py
(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ python fastai_classification_crossVal.py
Loading data snopes...
(118, 5)
0    mixture
1     mfalse
2    mixture
3    mixture
4      mtrue
5     ffalse
6     mfalse
7      mtrue
8     ffalse
9     ffalse
Name: label, dtype: object
['mixture' 'mfalse' 'mtrue' 'ffalse' 'ftrue']
Data from Snopes looks like...
0     Massive Pedophile Ring With '70,000 Elite Mem...
1     NBC Bay Area's SkyRanger on Saturday captured...
2     Today is Flag Day, the anniversary of when 19...
3     HONOLULU Federal authorities on Friday added ...
4     Text smaller    Text bigger    We have all he...
5     A 79-year-old retired officer of the CIA, Bil...
6     Governor Jerry Brown is retiring but not befo...
7     Sneed: 108 could be the Cubs magic number thi...
8     Clint Eastwood, more famous for westerns than...
9     Delaware City Council passed a resolution thi...
Name: data, dtype: object
[5, 1, 5, 5, 0, 1, 1, 0, 1, 1]
0    48
1    44
5    26
dtype: int64
Loading data buzzfeedtop...
(33, 15)
                                               title        ...              author_phase2
0  Babysitter transported to hospital after inser...        ...          Barbara Jennnings
1  FBI seizes over 3,000 penises during raid at m...        ...          Barbara Jennnings
2  Charles Manson to be released on parole, to Jo...        ...                        NaN

[3 rows x 15 columns]
Data from BuzzFeed looks like...
0    Cincinnati, Ohio | A 31-year old woman was adm...
1    FBI agents made an astonishing discovery this ...
2    Giant Squid Washes Ashore on Lake Michigan Mic...
3    Police have reportedly launched a murder inves...
4    Beaumont, Texas | An employee of the Jefferson...
5    WASHINGTON, DC (By J. McConkey)A group of lead...
6    WASHINGTON, D.C.  In another sweeping move aim...
7    Columbus, Ohio | An 83-year old woman was arre...
8    A couple was transported to the hospital in a ...
9    Darrel Whitaker from Glenwood Springs in Color...
Name: original_article_text_phase2, dtype: object
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
1    33
dtype: int64
Loading data perez...
(500, 3)
   Unnamed: 0                                               text  label
0           0  Jennifer Aniston dashes 'Friends' reunion hope...  legit
1           1  This Is What Brad Pitt Has Been Texting Jennif...  legit
2           2  Jennifer Aniston's spokesman denies reports th...  legit
Data from perez looks like...
0    Jennifer Aniston dashes 'Friends' reunion hope...
1    This Is What Brad Pitt Has Been Texting Jennif...
2    Jennifer Aniston's spokesman denies reports th...
3    Jennifer Aniston sparks adoption rumors\n\nBef...
4    Jennifer Aniston denies she had an affair with...
5    Jennifer Aniston: I'm Not a 'Sad, Childless Hu...
6    Jennifer Aniston Finally Pregnant At 48 Years ...
7    Brad Pitt is not reuniting with Jennifer Anist...
8    Miley And Liam Fighting? False Rumors Swirl Th...
9    Kristen Stewart not dropping another "Twilight...
Name: text, dtype: object
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
1    250
0    250
dtype: int64
Data loaded from disk!
(2600,) 866
Cross validation starts:
[ 434  435  436  437 ... 2596 2597 2598 2599] [   0    1    2    3 ... 1730 1731 1732 1733]
(1732,)
(868,)


 A sample of classifier training data:
   label                                               text
0      0  While Donald Trump Jr., Executive Vice Preside...
1      0  Anthony Weiner. | AP Photo/Richard Drew, File ...
2      0  Pence said the policy gives police authority t...
3      0  A shooter opened fire at the Cascade Mall on F...
4      0  VIDEO: Jimmy Fallon Sparks MOTHER LOAD Of ?Hur...
5      0  We are absolutely heartbroken to hear about th...
6      0   Looking for news you can trust?  Subscribe to...
7      0  Donald Trump took full advantage of the opport...
8      0   A school shooting at Marjory Stoneman Douglas...
9      0  Secretary of State John Kerry said at the Glob...
10     0  ?Charlotte should release police video of the ...
11     0   Were so close! Were just two weeks away from ...
12     0  "The West Wing" creator's storylines are provi...
13     0   Copyright by WFLA - All rights reserved  WKRG...
14     0  Story highlights Two police videos -- from a d...
15     0  Trump takes credit for 'bomb' call: 'I should ...
16     0  Former CIA chief: Obama's 'retrenchment' like ...
17     0  BOOM! Retired Marine Colonel Writes Scathing L...
18     0  ?Hedidn say the document was legitimate," Joe ...
19     0  Story highlights Hillary Clinton has a 6-point...
20     0  For the first time in PresidentObama tenure, t...
21     0  When word got out the Westboro Baptist Church ...
22     0   The brides parents Christopher and Denice, al...
23     0   This Thursday Ohio Republican Representative ...
24     0   Sen. Ted Cruzs comments came in response to a...
25     0  Under the Radar Blog Archives Select Date? Dec...
26     0  16505 SHARES SHARES FacebookTwitter GooglePint...
27     0  Clinton says doesn't bother her if Trump doesn...
28     0   Hillary Clinton and Donald Trump are still ho...
29     0  Story highlights "We have a much better unders...
..   ...                                                ...
70     0  Under the Radar Blog Archives Select Date? Dec...
71     0   This Friday, the Trump camp released a new li...
72     0  "I just wanted to get on with, I wanted to get...
73     0  Donald Trump on Tuesday morning floated the id...
74     0  The trust issue continues to be the major stum...
75     0   A photo of a man in Alberta mowing a lawn wit...
76     0  If Republicans and Donald Trump really care ab...
77     0  The epidemic of black men being killed at the ...
78     0  Story highlights "Transparent" creator Jill So...
79     0  Majority Leader Mitch McConnell announced the ...
80     0   Banks still doesn't know her reasoning for se...
81     0  On Saturday, September 17 at 8:30 pm EST, an e...
82     0  Were you worried that Donald Trump might fall ...
83     0   I didn't serve in the U.S. Military for 20+ y...
84     0  Story highlights The turn of events was somewh...
85     0  Obama weighs in on the debate President Barack...
86     0  The Third Circuit ruled on Monday that the tri...
87     0  2016 Clinton gets underTrump skin The Republic...
88     0  Mexico?s former President, Vicente Fox,isn shy...
89     0  Donald Trump has again made a huge mistake whi...
90     0   Apple will fight a federal magistrate's order...
91     0   Introduction to the ADA  The Americans with D...
92     0  Under the Radar Blog Archives Select Date? Dec...
93     0   US authorities will remove restrictions on im...
94     0   Hillary Clinton proposed on Thursday a new se...
95     0  A "journal" belonging to New York City bombing...
96     0  Several protesters and a dozen police officers...
97     0  Toby Keith has been forced to cancel his show ...
98     0  When Hillary Clinton resigned as U.S. secretar...
99     0  ?These wire transfers, Mr. President, seemingl...

[100 rows x 2 columns]
Language model loaded!
Building the text classifier...
epoch  train_loss  valid_loss  accuracy
1      0.557515    0.549768    0.701613
epoch  train_loss  valid_loss  accuracy
1      0.501141    0.424391    0.816820
saving the classifier...
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.6785, 0.3215]))
Results on all  data:
              precision    recall  f1-score   support

           0       0.88      0.78      0.83      1300
           1       0.80      0.90      0.85      1300

   micro avg       0.84      0.84      0.84      2600
   macro avg       0.84      0.84      0.84      2600
weighted avg       0.84      0.84      0.84      2600

Results on validation data:
              precision    recall  f1-score   support

           0       0.86      0.77      0.82       434
           1       0.79      0.88      0.83       434

   micro avg       0.82      0.82      0.82       868
   macro avg       0.83      0.82      0.82       868
weighted avg       0.83      0.82      0.82       868

Test results on data sampled only from snopes (snopes312 dataset manually checked right items -- unseen claims):
[[ 0 48]
 [ 1 44]
 [ 5 26]]
Discarding items for label 5
Final size of dataset:
[[ 0 48]
 [ 1 44]]
Final size of remaining dataset:
[[ 5 26]]
              precision    recall  f1-score   support

           0       0.58      0.15      0.23        48
           1       0.49      0.89      0.63        44

   micro avg       0.50      0.50      0.50        92
   macro avg       0.54      0.52      0.43        92
weighted avg       0.54      0.50      0.42        92

Test results on data sampled only from buzzfeedTop (mixed claims):
[[ 1 33]]
Final size of dataset:
[[ 1 33]]
Final size of remaining dataset:
[]
/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/metrics/classification.py:1145: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples.
  'recall', 'true', average, warn_for)
              precision    recall  f1-score   support

           0       0.00      0.00      0.00         0
           1       1.00      0.97      0.98        33

   micro avg       0.97      0.97      0.97        33
   macro avg       0.50      0.48      0.49        33
weighted avg       1.00      0.97      0.98        33

Test results on data sampled only from perez (celebrity stories):
[[  0 250]
 [  1 250]]
Final size of dataset:
[[  0 250]
 [  1 250]]
Final size of remaining dataset:
[]
              precision    recall  f1-score   support

           0       0.71      0.02      0.04       250
           1       0.50      0.99      0.67       250

   micro avg       0.51      0.51      0.51       500
   macro avg       0.61      0.51      0.35       500
weighted avg       0.61      0.51      0.35       500

[   0    1    2    3 ... 2596 2597 2598 2599] [ 434  435  436  437 ... 2163 2164 2165 2166]
(1734,)
(866,)


 A sample of classifier training data:
   label                                               text
0      0   Hail Trump, hail our people, hail victory!  T...
1      0  Trump?s Campaign Manager was interrupted on CN...
2      0  Trump suggests Tulsa officer was 'choking' in ...
3      0  DonaldTrump 1 point lead puts him in a statist...
4      0  With this presidential election being as absol...
5      0  HEMPSTEAD, N.Y. ? Hillary Clinton and Donald T...
6      0  Story highlights It was not clear how Donald T...
7      0  Story highlights "He's always looking for a ma...
8      0  Donald Trump during the first presidential deb...
9      0  The LA Times/USC Daily Tracking Poll began rep...
10     0  Hillary Clinton meets with Egyptian President ...
11     0  Donald Trump and then-wife, Ivana, pose aboard...
12     0   Democratic President Barack Obama pulled off ...
13     0  Story highlights Donald Trump reacted to a ser...
14     0  Former New York City Mayor Rudy Giuliani decid...
15     0   A new video has emerged of the moments before...
16     0   About the Author  Rob Spectre is a punk rock ...
17     0  Hillary Clinton has a 9-point advantage over D...
18     0  Chelsea Clinton said she is more concerned abo...
19     0  Donald Trump Jr. defends Skittles tweet: 'I?m ...
20     0  The impact of one line zingers can fade after ...
21     0  President Obama today vetoed a bill that would...
22     0   A 62-year-old German woman has been fined 1,3...
23     0  Clinton hits Trump over '$14 million' from fat...
24     0  Story highlights Poll: 62% say Clinton won, 27...
25     0   Breaking News Emails Get breaking news alerts...
26     0  Donald Trump spent Monday night making a total...
27     0   The New York Times has joined a number of oth...
28     0  When Donald Trump was asked by debate moderato...
29     0  BEHIND THE SCENES of the first debate: WHO WAS...
..   ...                                                ...
70     0  I want this administrator to contact me.It not...
71     0  Charlotte Mayor Jennifer Roberts blasted Donal...
72     0  Story highlights Former Sen. John Warner is ba...
73     0  As if this week was not tragic enough, we get ...
74     0   Available with daily admission, this viewing ...
75     0  Story highlights $28 million is set to be spen...
76     0  Story highlights Chris Coons said Donald Trump...
77     0  Posted by Frank Wilkenmeyer on 19 Sep 2016 Don...
78     0   Determined to end four years of often-brutal ...
79     0   President Barack Obama sharply criticized Rep...
80     0   Millions of people tuned in Monday night to w...
81     0  Rep. Robert Pittenger said Charlotte protester...
82     0  Donald Trump, Jr. seems to have taken over as ...
83     0  Ahmad Khan Rahami is pictured in an undated ph...
84     0  The show's former cast members will campaign f...
85     0  Saying ?you guys? is one of many microaggressi...
86     0  3910 SHARES Facebook Twitter Reddit Stumbleupo...
87     0  John Sununu hailed the real estate mogul as th...
88     0  Democrats are starting to show cracks in their...
89     0  The State Department initially proposed proces...
90     0  Donald Trump leads Hillary Clinton in Iowa 44 ...
91     0   Georgia Congressman Drew Ferguson was lambast...
92     0   (Sign up for the Science Times newsletter and...
93     0  I thinkwhat most likely is that the audience j...
94     0  BREAKING: Pipe Bombs Found in New Jersey Train...
95     0   Fox News is enjoying a sustained post-electio...
96     0  Trump not convinced of Russian hacking Hillary...
97     0  NEW YORK ? All politics is geopolitical in thi...
98     0  Share Tweet Email address: Leave this field em...
99     0  LeAnn Rimes opens up about the truth behind he...

[100 rows x 2 columns]
Language model loaded!
Building the text classifier...
epoch  train_loss  valid_loss  accuracy
1      0.524107    0.467965    0.801386
epoch  train_loss  valid_loss  accuracy
1      0.502364    0.419488    0.832564
saving the classifier...
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.6228, 0.3772]))
Results on all  data:
              precision    recall  f1-score   support

           0       0.89      0.77      0.83      1300
           1       0.80      0.90      0.85      1300

   micro avg       0.84      0.84      0.84      2600
   macro avg       0.84      0.84      0.84      2600
weighted avg       0.84      0.84      0.84      2600

Results on validation data:
              precision    recall  f1-score   support

           0       0.89      0.76      0.82       433
           1       0.79      0.91      0.85       433

   micro avg       0.83      0.83      0.83       866
   macro avg       0.84      0.83      0.83       866
weighted avg       0.84      0.83      0.83       866

Test results on data sampled only from snopes (snopes312 dataset manually checked right items -- unseen claims):
[[ 0 48]
 [ 1 44]
 [ 5 26]]
Discarding items for label 5
Final size of dataset:
[[ 0 48]
 [ 1 44]]
Final size of remaining dataset:
[[ 5 26]]
              precision    recall  f1-score   support

           0       0.64      0.15      0.24        48
           1       0.49      0.91      0.64        44

   micro avg       0.51      0.51      0.51        92
   macro avg       0.57      0.53      0.44        92
weighted avg       0.57      0.51      0.43        92

Test results on data sampled only from buzzfeedTop (mixed claims):
[[ 1 33]]
Final size of dataset:
[[ 1 33]]
Final size of remaining dataset:
[]
/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/metrics/classification.py:1145: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples.
  'recall', 'true', average, warn_for)
              precision    recall  f1-score   support

           0       0.00      0.00      0.00         0
           1       1.00      0.97      0.98        33

   micro avg       0.97      0.97      0.97        33
   macro avg       0.50      0.48      0.49        33
weighted avg       1.00      0.97      0.98        33

Test results on data sampled only from perez (celebrity stories):
[[  0 250]
 [  1 250]]
Final size of dataset:
[[  0 250]
 [  1 250]]
Final size of remaining dataset:
[]
              precision    recall  f1-score   support

           0       0.50      0.09      0.16       250
           1       0.50      0.91      0.64       250

   micro avg       0.50      0.50      0.50       500
   macro avg       0.50      0.50      0.40       500
weighted avg       0.50      0.50      0.40       500

[   0    1    2    3 ... 2163 2164 2165 2166] [ 867  868  869  870 ... 2596 2597 2598 2599]
(1734,)
(866,)


 A sample of classifier training data:
   label                                               text
0      0   Hail Trump, hail our people, hail victory!  T...
1      0  Trump?s Campaign Manager was interrupted on CN...
2      0  Trump suggests Tulsa officer was 'choking' in ...
3      0  DonaldTrump 1 point lead puts him in a statist...
4      0  With this presidential election being as absol...
5      0  HEMPSTEAD, N.Y. ? Hillary Clinton and Donald T...
6      0  Story highlights It was not clear how Donald T...
7      0  Story highlights "He's always looking for a ma...
8      0  Donald Trump during the first presidential deb...
9      0  The LA Times/USC Daily Tracking Poll began rep...
10     0  Hillary Clinton meets with Egyptian President ...
11     0  Donald Trump and then-wife, Ivana, pose aboard...
12     0   Democratic President Barack Obama pulled off ...
13     0  Story highlights Donald Trump reacted to a ser...
14     0  Former New York City Mayor Rudy Giuliani decid...
15     0   A new video has emerged of the moments before...
16     0   About the Author  Rob Spectre is a punk rock ...
17     0  Hillary Clinton has a 9-point advantage over D...
18     0  Chelsea Clinton said she is more concerned abo...
19     0  Donald Trump Jr. defends Skittles tweet: 'I?m ...
20     0  The impact of one line zingers can fade after ...
21     0  President Obama today vetoed a bill that would...
22     0   A 62-year-old German woman has been fined 1,3...
23     0  Clinton hits Trump over '$14 million' from fat...
24     0  Story highlights Poll: 62% say Clinton won, 27...
25     0   Breaking News Emails Get breaking news alerts...
26     0  Donald Trump spent Monday night making a total...
27     0   The New York Times has joined a number of oth...
28     0  When Donald Trump was asked by debate moderato...
29     0  BEHIND THE SCENES of the first debate: WHO WAS...
..   ...                                                ...
70     0  I want this administrator to contact me.It not...
71     0  Charlotte Mayor Jennifer Roberts blasted Donal...
72     0  Story highlights Former Sen. John Warner is ba...
73     0  As if this week was not tragic enough, we get ...
74     0   Available with daily admission, this viewing ...
75     0  Story highlights $28 million is set to be spen...
76     0  Story highlights Chris Coons said Donald Trump...
77     0  Posted by Frank Wilkenmeyer on 19 Sep 2016 Don...
78     0   Determined to end four years of often-brutal ...
79     0   President Barack Obama sharply criticized Rep...
80     0   Millions of people tuned in Monday night to w...
81     0  Rep. Robert Pittenger said Charlotte protester...
82     0  Donald Trump, Jr. seems to have taken over as ...
83     0  Ahmad Khan Rahami is pictured in an undated ph...
84     0  The show's former cast members will campaign f...
85     0  Saying ?you guys? is one of many microaggressi...
86     0  3910 SHARES Facebook Twitter Reddit Stumbleupo...
87     0  John Sununu hailed the real estate mogul as th...
88     0  Democrats are starting to show cracks in their...
89     0  The State Department initially proposed proces...
90     0  Donald Trump leads Hillary Clinton in Iowa 44 ...
91     0   Georgia Congressman Drew Ferguson was lambast...
92     0   (Sign up for the Science Times newsletter and...
93     0  I thinkwhat most likely is that the audience j...
94     0  BREAKING: Pipe Bombs Found in New Jersey Train...
95     0   Fox News is enjoying a sustained post-electio...
96     0  Trump not convinced of Russian hacking Hillary...
97     0  NEW YORK ? All politics is geopolitical in thi...
98     0  Share Tweet Email address: Leave this field em...
99     0  LeAnn Rimes opens up about the truth behind he...

[100 rows x 2 columns]
Language model loaded!
Building the text classifier...
epoch  train_loss  valid_loss  accuracy
1      0.558576    0.457291    0.790993
epoch  train_loss  valid_loss  accuracy
1      0.510108    0.430549    0.815242
saving the classifier...
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('1', tensor(1), tensor([0.4836, 0.5164]))
Results on all  data:
              precision    recall  f1-score   support

           0       0.84      0.81      0.82      1300
           1       0.82      0.85      0.83      1300

   micro avg       0.83      0.83      0.83      2600
   macro avg       0.83      0.83      0.83      2600
weighted avg       0.83      0.83      0.83      2600

Results on validation data:
              precision    recall  f1-score   support

           0       0.82      0.81      0.81       433
           1       0.81      0.82      0.82       433

   micro avg       0.81      0.81      0.81       866
   macro avg       0.81      0.81      0.81       866
weighted avg       0.81      0.81      0.81       866

Test results on data sampled only from snopes (snopes312 dataset manually checked right items -- unseen claims):
[[ 0 48]
 [ 1 44]
 [ 5 26]]
Discarding items for label 5
Final size of dataset:
[[ 0 48]
 [ 1 44]]
Final size of remaining dataset:
[[ 5 26]]
              precision    recall  f1-score   support

           0       0.62      0.21      0.31        48
           1       0.50      0.86      0.63        44

   micro avg       0.52      0.52      0.52        92
   macro avg       0.56      0.54      0.47        92
weighted avg       0.57      0.52      0.47        92

Test results on data sampled only from buzzfeedTop (mixed claims):
[[ 1 33]]
Final size of dataset:
[[ 1 33]]
Final size of remaining dataset:
[]
/home/ftorabia/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/metrics/classification.py:1145: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples.
  'recall', 'true', average, warn_for)
              precision    recall  f1-score   support

           0       0.00      0.00      0.00         0
           1       1.00      0.94      0.97        33

   micro avg       0.94      0.94      0.94        33
   macro avg       0.50      0.47      0.48        33
weighted avg       1.00      0.94      0.97        33

Test results on data sampled only from perez (celebrity stories):
[[  0 250]
 [  1 250]]
Final size of dataset:
[[  0 250]
 [  1 250]]
Final size of remaining dataset:
[]
              precision    recall  f1-score   support

           0       0.55      0.04      0.08       250
           1       0.50      0.96      0.66       250

   micro avg       0.50      0.50      0.50       500
   macro avg       0.53      0.50      0.37       500
weighted avg       0.53      0.50      0.37       500

(py36) ftorabia@Ling-DiscourseLab-GPU1:~/workspace/shared/sfu/fake_news/src$ packet_write_wait: Connection to 142.58.125.249: Broken pipe
fas-iMac:data fa$






