Data loaded from disk!
Reading language model data from ~/workspace/shared/sfu/fake_news/dump/fastai
0    Clinton's campaign manager tangles with 'Morni...
1    As my 25th wedding anniversary approached, I t...
2    Story highlights A New Jersey Port Authority o...
dtype: object
0    0
1    0
2    0
dtype: int64
Preparing the classifier and experiments using 3-fold CV



FOLD
[534 535 536 537 538 539 540 541 542 543]
[0 1 2 3 4 5 6 7 8 9]
train: 2132 validation: 1068


 A sample of classifier training data:
  label                                               text
0     0  The three Afghanistan National Army officers w...
1     0  ?There?s no question that the activities that ...
2     0  Michael Zehaf-Bibeau, the Muslim convert who f...
3     0  Michael Zehaf-Bibeau, the Muslim convert who f...
4     0  LOS ANGELES (CBS Seattle/AP) â A scorpion st...


 A sample of classifier validation data:
  label                                               text
0     0  Clinton's campaign manager tangles with 'Morni...
1     0  As my 25th wedding anniversary approached, I t...
2     0  Story highlights A New Jersey Port Authority o...
3     0  Michael Zehaf-Bibeau has been identified as th...
4     0   Alternative Titles: Operation Iraqi Freedom, ...
Building the text classifier
Language model loaded!
epoch  train_loss  valid_loss  accuracy
1      0.558299    0.484595    0.777154
epoch  train_loss  valid_loss  accuracy
1      0.523967    0.440821    0.797753
2      0.513871    0.422481    0.819288
3      0.484758    0.412310    0.823970
4      0.467679    0.405745    0.820225
5      0.451670    0.388547    0.829588
6      0.455477    0.436389    0.814607
7      0.427134    0.402992    0.831461
8      0.444129    0.403929    0.833333
9      0.425151    0.394544    0.838015
10     0.405443    0.451942    0.806180
11     0.409501    0.392816    0.835206
12     0.389206    0.385716    0.841760
13     0.369404    0.407896    0.836142
14     0.377832    0.369925    0.852060
15     0.393360    0.431481    0.830524
16     0.330453    0.387940    0.852060
17     0.353164    0.398643    0.831461
18     0.338856    0.373230    0.854869
19     0.326853    0.409526    0.838015
20     0.335168    0.406710    0.845506
21     0.347583    0.411067    0.833333
22     0.314623    0.396108    0.859551
23     0.307630    0.450267    0.844569
24     0.336638    0.400487    0.853933
25     0.280834    0.446577    0.830524
26     0.312871    0.402515    0.846442
27     0.274029    0.435581    0.839888
28     0.318510    0.489210    0.834270
29     0.283581    0.443523    0.829588
30     0.291249    0.470712    0.834270
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.9766, 0.0234]))
Results on training data:
              precision    recall  f1-score   support

           0       0.95      0.98      0.96      1066
           1       0.98      0.94      0.96      1066

   micro avg       0.96      0.96      0.96      2132
   macro avg       0.96      0.96      0.96      2132
weighted avg       0.96      0.96      0.96      2132

Results on validation data:
              precision    recall  f1-score   support

           0       0.82      0.89      0.85       534
           1       0.88      0.81      0.84       534

   micro avg       0.85      0.85      0.85      1068
   macro avg       0.85      0.85      0.85      1068
weighted avg       0.85      0.85      0.85      1068




FOLD
[0 1 2 3 4 5 6 7 8 9]
[534 535 536 537 538 539 540 541 542 543]
train: 2134 validation: 1066


 A sample of classifier training data:
  label                                               text
0     0  Clinton's campaign manager tangles with 'Morni...
1     0  As my 25th wedding anniversary approached, I t...
2     0  Story highlights A New Jersey Port Authority o...
3     0  Michael Zehaf-Bibeau has been identified as th...
4     0   Alternative Titles: Operation Iraqi Freedom, ...


 A sample of classifier validation data:
  label                                               text
0     0  The three Afghanistan National Army officers w...
1     0  ?There?s no question that the activities that ...
2     0  Michael Zehaf-Bibeau, the Muslim convert who f...
3     0  Michael Zehaf-Bibeau, the Muslim convert who f...
4     0  LOS ANGELES (CBS Seattle/AP) â A scorpion st...
Building the text classifier
Language model loaded!
epoch  train_loss  valid_loss  accuracy
1      0.550672    0.533846    0.763602
epoch  train_loss  valid_loss  accuracy
1      0.523643    0.451213    0.795497
2      0.480914    0.465053    0.802064
3      0.473374    0.470340    0.798311
4      0.435695    0.432490    0.807692
5      0.434109    0.445553    0.810507
6      0.434156    0.453482    0.820826
7      0.444228    0.422957    0.822702
8      0.428726    0.436544    0.827392
9      0.412817    0.401879    0.832083
10     0.400611    0.431307    0.818949
11     0.398211    0.417921    0.832083
12     0.383766    0.427189    0.816135
13     0.354841    0.407690    0.840525
14     0.373681    0.416993    0.842402
15     0.416491    0.412768    0.838649
16     0.383083    0.388251    0.838649
17     0.329674    0.417002    0.825516
18     0.343156    0.434396    0.827392
19     0.335695    0.464705    0.818011
20     0.330264    0.428695    0.823640
21     0.324482    0.417210    0.825516
22     0.322403    0.442289    0.823640
23     0.337441    0.446494    0.827392
24     0.288455    0.415943    0.845216
25     0.317802    0.438687    0.835835
26     0.309451    0.430434    0.844278
27     0.296178    0.439268    0.835835
28     0.324756    0.426402    0.826454
29     0.295203    0.417574    0.836773
30     0.294540    0.448310    0.844278
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.9809, 0.0191]))
Results on training data:
              precision    recall  f1-score   support

           0       0.96      0.96      0.96      1067
           1       0.96      0.96      0.96      1067

   micro avg       0.96      0.96      0.96      2134
   macro avg       0.96      0.96      0.96      2134
weighted avg       0.96      0.96      0.96      2134

Results on validation data:
              precision    recall  f1-score   support

           0       0.82      0.86      0.84       533
           1       0.85      0.82      0.83       533

   micro avg       0.84      0.84      0.84      1066
   macro avg       0.84      0.84      0.84      1066
weighted avg       0.84      0.84      0.84      1066




FOLD
[0 1 2 3 4 5 6 7 8 9]
[1067 1068 1069 1070 1071 1072 1073 1074 1075 1076]
train: 2134 validation: 1066


 A sample of classifier training data:
  label                                               text
0     0  Clinton's campaign manager tangles with 'Morni...
1     0  As my 25th wedding anniversary approached, I t...
2     0  Story highlights A New Jersey Port Authority o...
3     0  Michael Zehaf-Bibeau has been identified as th...
4     0   Alternative Titles: Operation Iraqi Freedom, ...


 A sample of classifier validation data:
  label                                               text
0     0  A British-born U.S. photojournalist and a Sout...
1     0  American photojournalist Luke Somers was kille...
2     0  Donald Trump took full advantage of the opport...
3     0  (CNN) The nation's billionaires -- energized b...
4     0   Image caption Lena Paahlsson says the ring wa...
Building the text classifier
Language model loaded!
epoch  train_loss  valid_loss  accuracy
1      0.576034    0.549413    0.754221
epoch  train_loss  valid_loss  accuracy
1      0.513938    0.442421    0.812383
2      0.508649    0.430204    0.813321
3      0.454006    0.393287    0.831144
4      0.444597    0.399903    0.831144
5      0.453084    0.395361    0.828330
6      0.414118    0.405436    0.833021
7      0.428351    0.374996    0.835835
8      0.387852    0.378027    0.839587
9      0.396944    0.359700    0.855535
10     0.392653    0.392788    0.830206
11     0.399608    0.367950    0.857411
12     0.408142    0.361198    0.841463
13     0.395877    0.361136    0.854597
14     0.401764    0.349146    0.857411
15     0.395866    0.356881    0.848030
16     0.358402    0.374883    0.846154
17     0.372752    0.376550    0.847092
18     0.349686    0.355724    0.849906
19     0.365697    0.351900    0.849906
20     0.332784    0.357571    0.866792
21     0.299538    0.376611    0.857411
22     0.313423    0.371938    0.867730
23     0.321323    0.403551    0.834897
24     0.308535    0.435019    0.824578
25     0.336380    0.379715    0.872420
26     0.302145    0.364175    0.859287
27     0.309332    0.397051    0.851782
28     0.302834    0.380143    0.852720
29     0.301131    0.373793    0.863039
30     0.271583    0.396021    0.873358
Prediction for sentence " Hilary Clinton won the 2016 US election" is ('0', tensor(0), tensor([0.9999, 0.0001]))
Results on training data:
              precision    recall  f1-score   support

           0       0.95      0.96      0.95      1067
           1       0.96      0.95      0.95      1067

   micro avg       0.95      0.95      0.95      2134
   macro avg       0.95      0.95      0.95      2134
weighted avg       0.95      0.95      0.95      2134

Results on validation data:
              precision    recall  f1-score   support

           0       0.89      0.84      0.87       533
           1       0.85      0.90      0.87       533

   micro avg       0.87      0.87      0.87      1066
   macro avg       0.87      0.87      0.87      1066
weighted avg       0.87      0.87      0.87      1066

REFIT on train+valid and then testing...
Building the text classifier
Language model loaded!
epoch  train_loss  valid_loss  accuracy
1      0.528841    0.521606    0.790000
epoch  train_loss  valid_loss  accuracy
1      0.503284    0.461964    0.810000
2      0.464840    0.412396    0.827500
3      0.432221    0.419053    0.816250
4      0.416653    0.393148    0.836250
5      0.405801    0.387614    0.837500
6      0.395844    0.373691    0.848750
7      0.363253    0.358159    0.842500
8      0.384353    0.368327    0.852500
9      0.335766    0.359725    0.855000
10     0.347080    0.348701    0.856250
11     0.355439    0.338959    0.861250
12     0.328399    0.342713    0.863750
13     0.311396    0.343329    0.863750
14     0.331104    0.363875    0.843750
15     0.302243    0.334453    0.871250
16     0.324708    0.353474    0.863750
17     0.305502    0.359994    0.853750
18     0.318597    0.360359    0.863750
19     0.272184    0.352039    0.866250
20     0.294866    0.342568    0.873750
21     0.263455    0.343496    0.862500
22     0.265818    0.362251    0.865000
23     0.301016    0.360139    0.867500
24     0.269837    0.363698    0.858750
25     0.235594    0.353429    0.867500
26     0.268318    0.363785    0.871250
27     0.257207    0.346601    0.868750
28     0.246747    0.362042    0.873750
29     0.235949    0.368719    0.867500
30     0.208539    0.378716    0.871250
Results on test data:
              precision    recall  f1-score   support

           0       0.90      0.84      0.87       400
           1       0.85      0.91      0.88       400

   micro avg       0.87      0.87      0.87       800
   macro avg       0.88      0.87      0.87       800
weighted avg       0.88      0.87      0.87       800

Loading data snopes...
(118, 5)
0    mixture
1     mfalse
2    mixture
3    mixture
4      mtrue
5     ffalse
6     mfalse
7      mtrue
8     ffalse
9     ffalse
Name: label, dtype: object
['mixture' 'mfalse' 'mtrue' 'ffalse' 'ftrue']
Data from Snopes looks like...
0     Massive Pedophile Ring With '70,000 Elite Mem...
1     NBC Bay Area's SkyRanger on Saturday captured...
2     Today is Flag Day, the anniversary of when 19...
3     HONOLULU Federal authorities on Friday added ...
4     Text smaller    Text bigger    We have all he...
5     A 79-year-old retired officer of the CIA, Bil...
6     Governor Jerry Brown is retiring but not befo...
7     Sneed: 108 could be the Cubs magic number thi...
8     Clint Eastwood, more famous for westerns than...
9     Delaware City Council passed a resolution thi...
Name: data, dtype: object
[5, 1, 5, 5, 0, 1, 1, 0, 1, 1]
0    48
1    44
5    26
dtype: int64
Test results on data sampled only from snopes (snopes312 dataset manually checked right items -- unseen claims):
[[ 0 48]
 [ 1 44]
 [ 5 26]]
Discarding items for label 5
Final size of dataset:
[[ 0 40]
 [ 1 40]]
Final size of remaining dataset:
[[ 0  8]
 [ 1  4]
 [ 5 26]]
              precision    recall  f1-score   support

           0       0.57      0.10      0.17        40
           1       0.51      0.93      0.65        40

   micro avg       0.51      0.51      0.51        80
   macro avg       0.54      0.51      0.41        80
weighted avg       0.54      0.51      0.41        80

